<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emerald â€” Markdown Editor</title>
    <meta name="description"
        content="A minimalist, distraction-free markdown editor with live preview, folder organization, and local storage.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@300;400;500;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="css/tokens.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/components.css">
</head>

<body>
    <!-- Home Screen (Desktop only) -->
    <div id="home-screen" class="home-screen" style="display: none;">

        <!-- Left: Branding -->
        <div class="home-left">
            <div class="home-brand">
                <span class="home-gem">ðŸ’Ž</span>
                <h1 class="home-app-name">Emerald</h1>
                <p class="home-tagline" data-i18n="home.subtitle">Select a workspace to start writing</p>
            </div>
            <div class="home-meta">
                <select id="home-lang-select" class="home-lang-select" aria-label="Language">
                    <option value="en">EN</option>
                    <option value="pt">PT</option>
                    <option value="es">ES</option>
                </select>
                <button id="home-about-inline-btn" class="home-about-btn">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>
                    <span data-i18n="menu.about">About</span>
                </button>
            </div>
        </div>

        <!-- Divider -->
        <div class="home-divider"></div>

        <!-- Right: Actions + Recent -->
        <div class="home-right">
            <div class="home-actions-group">
                <button class="home-action-btn primary" id="home-open-btn">
                    <svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z"></path>
                    </svg>
                    <span data-i18n="home.open_folder">Open Existing Folder</span>
                </button>
                <button class="home-action-btn secondary" id="home-create-btn">
                    <svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                        <line x1="12" y1="11" x2="12" y2="17"></line>
                        <line x1="9" y1="14" x2="15" y2="14"></line>
                    </svg>
                    <span data-i18n="home.create_new">Create New Workspace</span>
                </button>
                <button class="home-action-btn ghost" id="home-close-app-btn">
                    <svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4M16 17l5-5-5-5M21 12H9"></path>
                    </svg>
                    <span data-i18n="home.close_app">Exit Application</span>
                </button>
            </div>

            <div class="home-recent-section" id="home-recent-section" style="display: none;">
                <p class="home-section-label" data-i18n="home.recent">Recently Opened</p>
                <ul class="home-recent-list" id="home-recent-list"></ul>
            </div>
        </div>

    </div>

    <div class="app-layout" id="app-layout">

        <!-- Sidebar File Browser -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2 data-i18n="sidebar.notes">Notes</h2>
                <div class="sidebar-actions">
                    <button class="icon-btn" id="open-local-folder-btn" data-i18n-title="sidebar.open_folder"
                        style="display: none;">
                        <svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path
                                d="M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z">
                            </path>
                            <polyline points="10 12 14 12"></polyline>
                            <polyline points="12 10 14 12 12 14"></polyline>
                        </svg>
                    </button>
                    <button class="icon-btn" id="new-folder-btn" data-i18n-title="sidebar.new_folder">
                        <svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z">
                            </path>
                            <line x1="12" y1="11" x2="12" y2="17"></line>
                            <line x1="9" y1="14" x2="15" y2="14"></line>
                        </svg>
                    </button>
                    <button class="icon-btn" id="new-note-btn" data-i18n-title="sidebar.new_note">
                        <svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                    </button>
                </div>
            </div>
            <ul class="file-list" id="file-list"></ul>
        </aside>

        <!-- Main Workspace -->
        <div class="main-content">
            <header class="app-header">
                <input type="text" id="note-title" class="note-title-input" data-i18n-placeholder="header.untitled">
                <div class="controls">
                    <span class="save-status" id="save-status" data-i18n="header.saved">Saved</span>
                    <span class="word-count" id="word-count">0 <span data-i18n="header.words">words</span></span>

                    <!-- Hidden file inputs -->
                    <input type="file" id="file-input" accept=".md,.markdown,text/plain" style="display:none">
                    <input type="file" id="image-input" accept="image/*" style="display:none">

                    <!-- Language Dropdown -->
                    <select id="lang-select" class="header-lang-select" aria-label="Language"
                        data-i18n-title="lang.title">
                        <option value="en">EN</option>
                        <option value="pt">PT</option>
                        <option value="es">ES</option>
                    </select>

                    <!-- Save -->
                    <button class="icon-btn" id="save-note-btn" data-i18n-title="header.save_btn">
                        <svg width="19" height="19" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                            <polyline points="17 21 17 13 7 13 7 21"></polyline>
                            <polyline points="7 3 7 8 15 8"></polyline>
                        </svg>
                    </button>

                    <!-- â‹® Main Menu -->
                    <div class="app-menu-wrap">
                        <button class="icon-btn" id="app-menu-btn" aria-label="Menu" title="Menu" aria-haspopup="true"
                            aria-expanded="false">
                            <svg width="19" height="19" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="5" r="1"></circle>
                                <circle cx="12" cy="12" r="1"></circle>
                                <circle cx="12" cy="19" r="1"></circle>
                            </svg>
                        </button>
                    </div>

                    <!-- Window Controls (Electron only) -->
                    <div class="window-controls" id="window-controls" style="display: none;">
                        <button class="win-btn win-minimize" id="win-min" tabindex="-1">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                        </button>
                        <button class="win-btn win-maximize" id="win-max" tabindex="-1">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            </svg>
                        </button>
                        <button class="win-btn win-close" id="win-close" tabindex="-1">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="18" y1="6" x2="6" y2="18"></line>
                                <line x1="6" y1="6" x2="18" y2="18"></line>
                            </svg>
                        </button>
                    </div>

                </div>
            </header>

            <main class="editor-container">
                <div class="pane editor-pane">
                    <textarea id="editor" placeholder="Start typing markdown hereâ€¦"></textarea>
                </div>
                <div class="divider" id="divider"></div>
                <div class="pane preview-pane">
                    <div id="preview" class="markdown-body"></div>
                </div>
            </main>
        </div>
    </div>

    <!-- Context Menu -->
    <div id="context-menu" class="context-menu" hidden>
        <ul>
            <li id="cm-rename">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                </svg>
                <span data-i18n="cm.rename">Rename</span>
            </li>
            <li id="cm-delete" class="danger">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                </svg>
                <span data-i18n="cm.delete">Delete</span>
            </li>
        </ul>
    </div>

    <!-- Editor Context Menu -->
    <div id="editor-context-menu" class="context-menu" hidden>
        <ul>
            <li data-action="undo">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="9 14 4 9 9 4"></polyline>
                    <path d="M20 20v-7a4 4 0 0 0-4-4H4"></path>
                </svg>
                <span data-i18n="editor.undo">Undo</span> <span class="menu-shortcut">Ctrl+Z</span>
            </li>
            <li data-action="redo">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="15 14 20 9 15 4"></polyline>
                    <path d="M4 20v-7a4 4 0 0 1 4-4h12"></path>
                </svg>
                <span data-i18n="editor.redo">Redo</span> <span class="menu-shortcut">Ctrl+Y</span>
            </li>
            <li class="menu-separator"></li>
            <li data-action="cut">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="6" cy="20" r="3"></circle>
                    <circle cx="18" cy="20" r="3"></circle>
                    <line x1="8.12" y1="17.88" x2="19.07" y2="6.93"></line>
                    <line x1="19" y1="17" x2="8.93" y2="6.07"></line>
                </svg>
                <span data-i18n="editor.cut">Cut</span> <span class="menu-shortcut">Ctrl+X</span>
            </li>
            <li data-action="copy">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
                <span data-i18n="editor.copy">Copy</span> <span class="menu-shortcut">Ctrl+C</span>
            </li>
            <li data-action="paste">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
                    <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
                </svg>
                <span data-i18n="editor.paste">Paste</span> <span class="menu-shortcut">Ctrl+V</span>
            </li>
            <li class="menu-separator"></li>
            <li data-action="bold">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M6 4h8a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"></path>
                    <path d="M6 12h9a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"></path>
                </svg>
                <span data-i18n="editor.bold">Bold</span> <span class="menu-shortcut">Ctrl+B</span>
            </li>
            <li data-action="italic">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <line x1="19" y1="4" x2="10" y2="4"></line>
                    <line x1="14" y1="20" x2="5" y2="20"></line>
                    <line x1="15" y1="4" x2="9" y2="20"></line>
                </svg>
                <span data-i18n="editor.italic">Italic</span> <span class="menu-shortcut">Ctrl+I</span>
            </li>
            <li data-action="code">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="16 18 22 12 16 6"></polyline>
                    <polyline points="8 6 2 12 8 18"></polyline>
                </svg>
                <span data-i18n="editor.code">Code</span> <span class="menu-shortcut">Ctrl+`</span>
            </li>
            <li data-action="link">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                    <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                </svg>
                <span data-i18n="editor.link">Link</span>
            </li>
            <li class="menu-separator"></li>
            <li data-action="image">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                    <polyline points="21 15 16 10 5 21"></polyline>
                </svg>
                <span data-i18n="menu.insert_img">Insert Image</span>
            </li>
        </ul>
    </div>

    <!-- Theme Editor Modal -->
    <div id="theme-modal-overlay" class="modal-overlay" hidden>
        <div class="modal theme-modal">
            <div class="help-modal-header">
                <h3 class="modal-title" data-i18n="theme.title">Theme Editor</h3>
                <button class="icon-btn" id="theme-modal-close" data-i18n-title="help.close_modal">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="theme-editor-body">

                <!-- Mode Toggle -->
                <div class="theme-row">
                    <label class="theme-label" data-i18n="theme.color_mode">Color Mode</label>
                    <div class="mode-toggle" id="mode-toggle">
                        <button class="mode-btn active" data-mode="dark">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                            </svg>
                            <span data-i18n="theme.dark">Dark</span>
                        </button>
                        <button class="mode-btn" data-mode="light">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="5"></circle>
                                <line x1="12" y1="1" x2="12" y2="3"></line>
                                <line x1="12" y1="21" x2="12" y2="23"></line>
                                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                                <line x1="1" y1="12" x2="3" y2="12"></line>
                                <line x1="21" y1="12" x2="23" y2="12"></line>
                                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                            </svg>
                            <span data-i18n="theme.light">Light</span>
                        </button>
                    </div>
                </div>

                <!-- Accent Color -->
                <div class="theme-row">
                    <label class="theme-label" data-i18n="theme.accent">Accent Color</label>
                    <div class="accent-swatches" id="accent-swatches">
                        <button class="swatch active" data-hsl="250,100%,65%" style="background:hsl(250,100%,65%)"
                            title="Violet"></button>
                        <button class="swatch" data-hsl="210,100%,60%" style="background:hsl(210,100%,60%)"
                            title="Blue"></button>
                        <button class="swatch" data-hsl="185,90%,45%" style="background:hsl(185,90%,45%)"
                            title="Cyan"></button>
                        <button class="swatch" data-hsl="142,65%,48%" style="background:hsl(142,65%,48%)"
                            title="Green"></button>
                        <button class="swatch" data-hsl="30,100%,58%" style="background:hsl(30,100%,58%)"
                            title="Orange"></button>
                        <button class="swatch" data-hsl="320,90%,62%" style="background:hsl(320,90%,62%)"
                            title="Pink"></button>
                        <button class="swatch" data-hsl="0,85%,60%" style="background:hsl(0,85%,60%)"
                            title="Red"></button>
                        <label class="swatch swatch-custom" title="Custom color">
                            <input type="color" id="accent-custom" value="#7c4dff">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2.5">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                        </label>
                    </div>
                </div>

                <!-- Editor Font -->
                <div class="theme-row">
                    <label class="theme-label" for="editor-font-select" data-i18n="theme.font">Editor Font</label>
                    <select id="editor-font-select" class="theme-select">
                        <option value="'Fira Code', monospace">Fira Code</option>
                        <option value="'JetBrains Mono', monospace">JetBrains Mono</option>
                        <option value="'Source Code Pro', monospace">Source Code Pro</option>
                        <option value="'Cascadia Code', monospace">Cascadia Code</option>
                        <option value="monospace">System Mono</option>
                    </select>
                </div>

                <!-- Editor Font Size -->
                <div class="theme-row">
                    <label class="theme-label"><span data-i18n="theme.font_size">Editor Font Size</span> <span
                            id="font-size-val" class="theme-value">15px</span></label>
                    <input type="range" id="editor-font-size" min="12" max="20" step="1" value="15"
                        class="theme-slider">
                </div>

                <!-- Line Height -->
                <div class="theme-row">
                    <label class="theme-label"><span data-i18n="theme.line_height">Line Height</span> <span
                            id="line-height-val" class="theme-value">1.75</span></label>
                    <input type="range" id="editor-line-height" min="1.4" max="2.2" step="0.05" value="1.75"
                        class="theme-slider">
                </div>

                <!-- Animated Wallpaper -->
                <div class="theme-row">
                    <label class="theme-label" data-i18n="theme.anim_bg">Animated Background</label>
                    <select id="anim-bg-select" class="theme-select">
                        <option value="default" data-i18n="theme.anim_default">Default Emerald</option>
                        <option value="aurora" data-i18n="theme.anim_aurora">Aurora Borealis</option>
                        <option value="cyberpunk" data-i18n="theme.anim_cyberpunk">Cyberpunk Neon</option>
                        <option value="ocean" data-i18n="theme.anim_ocean">Ocean Deep</option>
                        <option value="sunset" data-i18n="theme.anim_sunset">Sunset Horizon</option>
                    </select>
                </div>

                <!-- Reset -->
                <div class="theme-row theme-row-actions">
                    <button class="btn-secondary" id="theme-reset-btn" data-i18n="theme.reset">Reset to
                        defaults</button>
                </div>

            </div>
        </div>
    </div>

    <!-- Shortcuts Help Modal -->
    <div id="help-modal-overlay" class="modal-overlay" hidden>
        <div class="modal help-modal">
            <div class="help-modal-header">
                <h3 class="modal-title" data-i18n="help.title">Keyboard Shortcuts</h3>
                <button class="icon-btn" id="help-modal-close" data-i18n-title="help.close_modal">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="help-grid">

                <section class="help-section">
                    <h4 data-i18n="help.file">File</h4>
                    <div class="shortcut-row"><span data-i18n="help.save">Save</span><kbd>Ctrl</kbd><kbd>S</kbd></div>
                    <div class="shortcut-row"><span data-i18n="help.download">Download
                            .md</span><kbd>Ctrl</kbd><kbd>D</kbd></div>
                </section>

                <section class="help-section">
                    <h4 data-i18n="help.format">Formatting</h4>
                    <div class="shortcut-row"><span data-i18n="help.bold">Bold</span><kbd>Ctrl</kbd><kbd>B</kbd></div>
                    <div class="shortcut-row"><span data-i18n="help.italic">Italic</span><kbd>Ctrl</kbd><kbd>I</kbd>
                    </div>
                    <div class="shortcut-row"><span data-i18n="help.code">Code / Code
                            block</span><kbd>Ctrl</kbd><kbd>`</kbd></div>
                </section>

                <section class="help-section">
                    <h4 data-i18n="help.editor">Editor</h4>
                    <div class="shortcut-row"><span data-i18n="help.undo">Undo</span><kbd>Ctrl</kbd><kbd>Z</kbd></div>
                    <div class="shortcut-row"><span data-i18n="help.redo">Redo</span><kbd>Ctrl</kbd><kbd>Y</kbd></div>
                    <div class="shortcut-row"><span data-i18n="help.rc_menu">Right-click
                            menu</span><kbd>Right-click</kbd></div>
                </section>

                <section class="help-section">
                    <h4 data-i18n="help.nav">Navigation</h4>
                    <div class="shortcut-row"><span data-i18n="help.open_shortcuts">Open shortcuts</span><kbd>?</kbd>
                    </div>
                    <div class="shortcut-row"><span data-i18n="help.close_modal">Close modal / Menu</span><kbd>Esc</kbd>
                    </div>
                </section>

                <section class="help-section">
                    <h4 data-i18n="help.img">Images</h4>
                    <div class="shortcut-row"><span data-i18n="help.insert_img_rc">Right-click &rarr; Insert
                            Image</span></div>
                    <div class="shortcut-row"><span data-i18n="help.paste_img">Paste from clipboard (in
                            editor)</span><kbd>Ctrl</kbd><kbd>V</kbd></div>
                    <div class="shortcut-row"><span data-i18n="help.drag_drop">Drop onto editor pane</span></div>
                </section>

                <section class="help-section">
                    <h4 data-i18n="help.syntax">Markdown Syntax</h4>
                    <div class="shortcut-row"><span><code># Heading 1</code></span></div>
                    <div class="shortcut-row"><span><code>**bold**</code></span></div>
                    <div class="shortcut-row"><span><code>*italic*</code></span></div>
                    <div class="shortcut-row"><span><code>[link](url)</code></span></div>
                    <div class="shortcut-row"><span><code>![alt](img://id =600x)</code> â€” image with width</span></div>
                    <div class="shortcut-row"><span><code>- item</code> â€” unordered list</span></div>
                    <div class="shortcut-row"><span><code>1. item</code> â€” ordered list</span></div>
                    <div class="shortcut-row"><span><code>> quote</code> â€” blockquote</span></div>
                    <div class="shortcut-row"><span><code>```lang</code> â€” code block</span></div>
                </section>

            </div>
        </div>
    </div>

    <!-- Image Insert Modal -->
    <div id="image-modal-overlay" class="modal-overlay" hidden>
        <div class="modal">
            <h3 class="modal-title" data-i18n="img.title">Insert Image</h3>
            <div class="modal-preview-wrap">
                <img id="modal-img-preview" src="" alt="preview">
            </div>
            <div class="modal-fields">
                <label for="modal-img-alt" data-i18n="img.alt">Alt text</label>
                <input type="text" id="modal-img-alt" data-i18n-placeholder="img.alt_placeholder">

                <label for="modal-img-width"><span data-i18n="img.width">Display width (px)</span> <span
                        class="label-hint" data-i18n="img.width_hint">&mdash; leave blank for full
                        width</span></label>
                <input type="number" id="modal-img-width" placeholder="e.g. 600" min="50" max="4000">

                <label for="modal-img-quality"><span data-i18n="img.quality">Resize before storing</span> <span
                        class="label-hint" data-i18n="img.quality_hint">&mdash; max edge, reduces
                        file size</span></label>
                <select id="modal-img-quality">
                    <option value="3840" data-i18n="img.og_size">Original size</option>
                    <option value="1920">1920 px</option>
                    <option value="1280" selected data-i18n="img.rec_size">1280 px (recommended)</option>
                    <option value="800">800 px</option>
                    <option value="400" data-i18n="img.thumb_size">400 px (thumbnail)</option>
                </select>
            </div>
            <div class="modal-actions">
                <button class="btn-secondary" id="modal-cancel-btn" data-i18n="img.cancel">Cancel</button>
                <button class="btn-primary" id="modal-insert-btn" data-i18n="img.insert">Insert</button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="delete-modal" class="modal-overlay" hidden>
        <div class="modal delete-modal">
            <div class="delete-icon-box">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#ff5f56" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3 6h18m-2 0v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6m3 0V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>
                    <line x1="10" y1="11" x2="10" y2="17"></line>
                    <line x1="14" y1="11" x2="14" y2="17"></line>
                </svg>
            </div>
            <h3 class="modal-title" id="delete-modal-title" style="margin-bottom: 8px;">Delete Item</h3>
            <p id="delete-modal-body" style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 24px;">This
                action cannot be undone.</p>
            <div class="modal-actions" style="justify-content: center; gap: 12px;">
                <button class="btn-secondary" id="delete-cancel-btn" style="flex: 1;"
                    data-i18n="img.cancel">Cancel</button>
                <button class="btn-primary danger" id="delete-confirm-btn" style="flex: 1;"
                    data-i18n="cm.delete">Delete</button>
            </div>
        </div>
    </div>

    <!-- About Modal -->
    <div id="about-modal-overlay" class="modal-overlay" hidden>
        <div class="modal" style="text-align: center; width: 400px; padding: 32px 24px;">
            <div style="font-size: 3.5rem; margin-bottom: 12px; pointer-events: none; user-select: none;">ðŸ’Ž</div>
            <h3 class="modal-title" data-i18n="about.title" style="margin-bottom: 4px; font-size: 1.4rem;">About Emerald
            </h3>
            <p style="color: var(--text-secondary); font-family: var(--font-mono); font-size: 0.8rem; margin-bottom: 16px;"
                data-i18n="about.version">Version 1.0.0</p>
            <p style="color: var(--text-primary); font-size: 0.95rem; line-height: 1.6; margin-bottom: 20px;"
                data-i18n="about.desc">
                A lightweight, self-hosted markdown editor with live preview, folder organization, image support, and
                full theme customization. No accounts. No cloud.
            </p>
            <div style="margin-bottom: 24px; font-size: 0.85rem; color: var(--text-secondary);">
                Developed by <a href="https://github.com/FilipeBarral" target="_blank" rel="noopener noreferrer"
                    style="color: var(--accent); text-decoration: none; font-weight: 600;">Filipe Barral</a>
            </div>
            <div class="modal-actions" style="justify-content: center;">
                <button class="btn-primary" id="about-close-btn" data-i18n="about.close">Close</button>
            </div>
        </div>
    </div>

    <!-- â‹® Main Menu (Moved outside app layout to fix z-index tracking) -->
    <div id="app-menu" class="app-menu" hidden>
        <ul>
            <li data-menu="theme">
                <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path
                        d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83">
                    </path>
                </svg>
                <span data-i18n="menu.theme">Theme Settings</span>
            </li>
            <li data-menu="image">
                <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                    <polyline points="21 15 16 10 5 21"></polyline>
                </svg>
                <span data-i18n="menu.insert_img">Insert Image</span>
            </li>
            <li data-menu="download">
                <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                <span data-i18n="menu.download">Download File</span>
                <span class="menu-shortcut">Ctrl+D</span>
            </li>
            <li data-menu="open">
                <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path
                        d="M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z">
                    </path>
                </svg>
                <span data-i18n="menu.open">Open File</span>
            </li>
            <li data-menu="help">
                <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                    <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
                <span data-i18n="menu.help">Help &amp; Shortcuts</span>
                <span class="menu-shortcut">?</span>
            </li>
            <li data-menu="about">
                <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="16" x2="12" y2="12"></line>
                    <line x1="12" y1="8" x2="12.01" y2="8"></line>
                </svg>
                <span data-i18n="menu.about">About Emerald</span>
            </li>
            <li data-menu="delete" class="danger">
                <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
                    </path>
                </svg>
                <span data-i18n="menu.delete">Delete Note</span>
            </li>
            <li data-menu="close-folder" class="danger" id="menu-close-folder" style="display: none;">
                <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M18 6L6 18M6 6l12 12"></path>
                </svg>
                <span data-i18n="menu.close_workspace">Close Workspace</span>
            </li>
        </ul>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.8/purify.min.js"></script>
    <script type="module" src="js/main.js"></script>
</body>

</html>